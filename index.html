<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ritual Community</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* === CENTERED BANNER (1350×100, по центру, кликабельный, просто обновляет страницу) === */
        .centered-banner {
          width: 100%;
          height: 100px; /* высота 100px */
          position: sticky;
          top: 0;
          z-index: 1000; /* Высокий z-index, чтобы баннер был поверх других элементов */
          display: flex;
          justify-content: center; /* центрирует содержимое по горизонтали */
          align-items: center;     /* центрирует содержимое по вертикали */
          background: #0d1117; /* фон, если изображение не загрузится */
          border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .banner-link {
          display: block;
          width: 1350px;   /* фиксированная ширина изображения */
          height: 100px;   /* фиксированная высота */
          background: url("https://i.yapx.ru/cInFv.png") no-repeat center center; /* <-- ССЫЛКА НА ИЗОБРАЖЕНИЕ БАННЕРА */
          background-size: 1350px 100px; /* точный размер изображения */
          cursor: pointer; /* Курсор указывает на возможность клика */
        }

        /* === LANGUAGE SWITCHER (в правом верхнем углу) === */
        .lang-switcher {
          position: absolute; /* Используем absolute, чтобы точно прижать к углу внутри sticky .centered-banner */
          top: 10px;
          right: 10px;
          z-index: 1001; /* Выше, чем баннер */
          display: flex;
          gap: 2px; /* Маленький зазор между кнопками */
        }

        .lang-btn {
          background: #2F4F4F;
          color: #aaa; /* Неактивный цвет */
          border: 1px solid #6fe3d1;
          border-radius: 5px;
          padding: 5px 8px;
          cursor: pointer;
          font-size: 0.9em;
          transition: background-color 0.2s, color 0.2s;
        }

        .lang-btn:first-child {
          border-radius: 5px 0 0 5px; /* Скругление только у левой кнопки */
        }

        .lang-btn:last-child {
          border-radius: 0 5px 5px 0; /* Скругление только у правой кнопки */
          border-left: none; /* Убираем левую границу у правой кнопки */
        }

        .lang-btn.active {
          background: #6fe3d1; /* Цвет активной кнопки */
          color: #0d1117; /* Цвет текста активной кнопки */
        }

        .lang-btn:hover {
          background: #4a6b6b; /* Цвет при наведении */
        }

        .lang-btn.active:hover {
          background: #5bc0bd; /* Цвет активной кнопки при наведении */
        }

        /* === ЦЕНТРИРОВАНИЕ ЗАГОЛОВКА "User" (АЛЬТЕРНАТИВНЫЙ МЕТОД) === */
        /* Применяем стили непосредственно к ячейке заголовка таблицы */
        #name-header {
          /* Используем flexbox для центрирования содержимого */
          display: flex !important;
          justify-content: center !important; /* Центрирует по горизонтали */
          align-items: center !important; /* Центрирует по вертикали */
          text-align: center !important; /* На всякий случай, для inline-элементов внутри */
          /* Убедимся, что ширина позволяет центрировать */
          width: auto !important; /* Используем auto, чтобы ширина определялась содержимым или таблицей */
        }
        /* Если внутри #name-header есть вложенные элементы (например, span с текстом или стрелка сортировки),
           они также должны центрироваться. Flexbox родителя обычно решает это. */
        #name-header .sort-arrow {
          /* Убедимся, что стрелка (если есть) также центрирована внутри flex-контейнера */
          margin-left: 5px; /* Отступ от текста, если он есть */
          /* Не нужно задавать justify-content для стрелки, так как она внутри flex-контейнера заголовка */
        }

        /* === СМЕЩЕНИЕ ЗАГОЛОВКА "User" ВПРАВО (на 1.5 см или 15px от левого края) === */
        /* Используйте это правило ВМЕСТО предыдущего блока, если нужно смещение */
        #name-header {
          text-align: left !important; /* Выравнивание по левому краю */
          padding-left: 15px !important; /* Отступ слева. Меняйте значение (15px) на 10px или 20px для другого сдвига */
          /* Остальные стили, если были, можно убрать или оставить, если они не мешают */
        }

        /* === LEADERBOARD TABLE === */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            border-radius: 5px; /* Уменьшено скругление */
            overflow: hidden;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
        }

        /* === ОБЪЕДИНЁННЫЙ БЛОК В НИЖНЕЙ ЧАСТИ === */
        .combined-bottom-block {
          display: flex; /* Используем flexbox */
          flex-wrap: wrap; /* Разрешаем перенос на новую строку при необходимости */
          align-items: center; /* Выравнивание по центру по вертикали */
          justify-content: space-between; /* Распределяет пространство между дочерними элементами */
          gap: 10px; /* Небольшой отступ между элементами */
          margin-top: 15px; /* Отступ сверху */
          padding: 10px; /* Внутренний отступ */
          background: rgba(255, 255, 255, 0.02); /* Легкий фон, если нужно */
          border-radius: 12px; /* Скругление углов */
          width: 100%; /* Занимает всю ширину родителя */
        }

        /* Убедимся, что .team-box и .tabs растягиваются правильно */
        .combined-bottom-block .team-box {
          margin: 0; /* Сбрасываем отступы, если были */
          flex: 1; /* Занимает доступное пространство */
          min-width: 0; /* Позволяет сжиматься */
        }

        .combined-bottom-block .team-box p {
          margin: 0; /* Сбрасываем отступы у параграфа */
          white-space: nowrap; /* Предотвращаем перенос текста внутри team-box */
          overflow: hidden; /* Скрываем переполнение */
          text-overflow: ellipsis; /* Добавляем многоточие при переполнении */
        }

        .combined-bottom-block .tabs {
          display: flex; /* Убедимся, что .tabs использует flex */
          gap: 5px; /* Отступ между кнопками вкладок */
          margin: 0; /* Сбрасываем отступы */
          /* Убираем стили, которые могли задавать display: block или width: 100% */
          width: auto; /* Ширина по содержимому */
        }

        /* === НОВЫЙ ПРИВЕТСТВЕННЫЙ БЛОК (по скриншоту) === */
        .welcome-section-new {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start; /* Выравнивание по верхнему краю */
            gap: 20px; /* Отступ между левой и правой частью */
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #2F4F4F, #1a2a2a);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 5%;
            color: #fff;
            position: relative;
            overflow: hidden;
        }

        .welcome-section-new::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50" x="50" font-size="80" text-anchor="middle" fill="white" opacity="0.1">✦✧✦✧</text></svg>');
            background-repeat: repeat;
            background-size: 100px;
            pointer-events: none;
            z-index: -1;
        }

        .welcome-header {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Выравнивание содержимого по левому краю */
            flex: 1; /* Левая часть занимает доступное пространство */
            min-width: 0; /* Позволяет сжиматься */
        }

        .welcome-header h1 {
            margin-top: 0;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
        }

        .dev-info-box {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5%;
            padding: 10px 15px;
            font-size: 0.9rem;
            line-height: 1.4;
            color: #a9ddd3;
            align-self: flex-start; /* Прижимаем блок разработчиков к верху */
        }

        .dev-info-box p {
            margin: 5px 0;
            white-space: nowrap;
        }

        .dev-info-box a {
            color: #6fe3d1;
            text-decoration: underline;
        }

        .dev-info-box a:hover {
            text-decoration: none;
        }

        .welcome-content {
            font-size: 1.1rem;
            line-height: 1.5;
            color: #fff;
            flex: 2; /* Правая часть (контент) занимает больше места */
            min-width: 0; /* Позволяет сжиматься */
        }

        .welcome-content p {
            margin: 8px 0;
        }

        .welcome-content a {
            color: #6fe3d1;
            text-decoration: underline;
        }

        .welcome-content a:hover {
            text-decoration: none;
        }

    </style>
</head>
<body>
    <!-- === BANNER (теперь просто обновляет страницу) === -->
    <div class="centered-banner">
        <a href="javascript:location.reload()" class="banner-link"></a>
        <!-- === LANGUAGE SWITCHER (в правом верхнем углу) === -->
        <div class="lang-switcher">
            <span id="lang-en" class="lang-btn active">EN</span>
            <span id="lang-ru" class="lang-btn">RU</span>
        </div>
    </div>

    <div class="background"></div>

    <!-- УБРАН: <div class="header-fixed"> <h1>Ritual Community</h1> </div> -->

    <div class="container">
        <!-- === НОВЫЙ WELCOME SECTION (по скриншоту) === -->
        <div class="welcome-section-new">
            <div class="welcome-header">
                <h1>WELCOME!</h1>
                <!-- Блок с информацией о разработчиках -->
                <div class="dev-info-box">
                    <p><strong>Developer —</strong> <a href="https://x.com/makssay_eth" target="_blank">@makssay_eth</a></p>
                    <p><strong>Art Creator —</strong> <a href="https://x.com/marrr_marina" target="_blank">@marrr_marina</a></p>
                </div>
            </div>
            <div class="welcome-content">
                <p>The leaderboard is based on all posts published inside the <a href="https://x.com/i/communities/1896991026272723220" target="_blank">Ritual Community</a>.</p>
                <p>Posts published outside the community will not appear here.</p>
                <p>Click on any participant to view their works.</p>
                <p>Click on any metric (e.g. Likes or Views) to sort.</p>
                <p>Last update: <span id="last-updated">—</span></p>
            </div>
        </div>

        <!-- Новый объединённый блок -->
        <div class="combined-bottom-block">
            <div class="tabs">
                <button class="tab-btn active" data-tab="leaderboard">Leaderboard</button>
                <button class="tab-btn" data-tab="analytics">Analytics</button>
            </div>

            <div class="team-box">
                <p>Follow Developer - <a href="https://x.com/kaye_moni" target="_blank">@kaye_moni</a></p>
            </div>
        </div>

        <!-- wrapper for leaderboard content so we can toggle visibility -->
        <div id="leaderboard-wrapper" class="tab-content active">
            
            <!-- Общая статистика -->
            <div class="stats">
                <div class="stat-box" id="total-posts">Total Posts: 0</div>
                <div class="stat-box" id="total-users">Total Users: 0</div>
                <div class="stat-box" id="total-views">Total Views: 0</div>
            </div>

            <!-- === SEARCH AND TIME FILTER IN ONE LINE === -->
            <div class="search-time-filter-container">
                <div class="search-section">
                    <label for="search" class="search-label">SEARCH USER</label>
                    <input type="text" id="search" placeholder="Type @handle or part of name..." class="search-input">
                </div>
                <div class="filter-section">
                    <span class="filter-label">FILTER BY TIME:</span>
                    <select id="time-select" class="time-select">
                        <option value="7">Last 7 days</option>
                        <option value="14">Last 14 days</option>
                        <option value="30">Last 30 days</option>
                        <option value="all" selected>All time</option>
                    </select>
                    <!-- Кнопка Refresh удалена -->
                </div>
            </div>

            <!-- Таблица лидеров -->
            <table id="leaderboard">
                <thead>
                    <tr>
                        <th id="name-header">User</th>
                        <th id="posts-header">Posts <span class="sort-arrow">▲</span></th>
                        <th id="likes-header">Likes <span class="sort-arrow"></span></th>
                        <th id="retweets-header">Retweets <span class="sort-arrow"></span></th>
                        <th id="comments-header">Comments <span class="sort-arrow"></span></th>
                        <th id="views-col-header">Views <span class="sort-arrow"></span></th>
                    </tr>
                </thead>
                <tbody id="leaderboard-body"></tbody>
            </table>

            <!-- Пагинация -->
            <div class="pagination">
                <button id="prev-page">Previous</button>
                <span id="page-info"></span>
                <button id="next-page">Next</button>
            </div>

            <!-- Твиты выбранного пользователя -->
            <div id="tweets-container" style="margin-top: 20px;">
                <ul id="tweets-list"></ul>
            </div>
        </div>

        <!-- Analytics tab content (hidden by default) -->
        <div id="tab-analytics" class="tab-content" style="display:none; text-align:left;">
            <h2>Analytics</h2>

            <!-- Time filter for analytics -->
            <div class="analytics-time-filter" style="display:flex; gap:10px; align-items:center; margin-bottom:18px; background: rgba(255,255,255,0.02); padding:12px; border-radius:12px;">
                <label for="analytics-time-select" style="font-weight:600; color:#a9ddd3; white-space:nowrap;">Filter by time:</label>
                <select id="analytics-time-select" style="flex:1; max-width:180px;">
                    <option value="all">All time</option>
                    <option value="30">Last 30 days</option>
                    <option value="14">Last 14 days</option>
                    <option value="7">Last 7 days</option>
                </select>
                <!-- НОВЫЙ ФИЛЬТР ПО ЧАСАМ -->
                <label for="hour-select" style="font-weight:600; color:#a9ddd3; white-space:nowrap;">Filter by hour:</label>
                <select id="hour-select" style="flex:1; max-width:180px;">
                    <option value="all">All hours</option>
                    <option value="0">00:00</option>
                    <option value="1">01:00</option>
                    <option value="2">02:00</option>
                    <option value="3">03:00</option>
                    <option value="4">04:00</option>
                    <option value="5">05:00</option>
                    <option value="6">06:00</option>
                    <option value="7">07:00</option>
                    <option value="8">08:00</option>
                    <option value="9">09:00</option>
                    <option value="10">10:00</option>
                    <option value="11">11:00</option>
                    <option value="12">12:00</option>
                    <option value="13">13:00</option>
                    <option value="14">14:00</option>
                    <option value="15">15:00</option>
                    <option value="16">16:00</option>
                    <option value="17">17:00</option>
                    <option value="18">18:00</option>
                    <option value="19">19:00</option>
                    <option value="20">20:00</option>
                    <option value="21">21:00</option>
                    <option value="22">22:00</option>
                    <option value="23">23:00</option>
                </select>
            </div>

            <!-- Nested tabs for analytics sections -->
            <div class="analytics-nested-tabs">
                <button class="analytics-tab-btn active" data-analytics-tab="averages">Avg metrics</button>
                <button class="analytics-tab-btn" data-analytics-tab="authors">Top 10 authors</button>
                <button class="analytics-tab-btn" data-analytics-tab="posts">Top 10 posts</button>
            </div>

            <!-- 1) Average metrics per user -->
            <section class="analytics-nested-content active" id="analytics-averages-section" data-analytics-section="averages">
                <div class="analytics-block" id="analytics-averages">
                    <h3>Average metrics per user</h3>
                    <div class="analytics-row" style="display:flex; gap:12px; flex-wrap:wrap;">
                        <div class="stat-box" id="avg-posts">Avg Posts: -</div>
                        <div class="stat-box" id="avg-likes">Avg Likes: -</div>
                        <div class="stat-box" id="avg-views">Avg Views: -</div>
                    </div>
                    
                    <!-- Heatmap Section -->
                    <div class="analytics-block" style="margin-top: 16px;">
                        <h3>Activity Heatmap (Tweets by Day & Hour)</h3>
                        <div id="heatmap-container" style="display: grid; grid-template-columns: repeat(24, 1fr); gap: 2px; margin-top: 12px;"></div>
                        <div style="display: flex; gap: 8px; margin-top: 8px; font-size: 0.85rem; color: #999;">
                            <div>Sun</div> <div>Mon</div> <div>Tue</div> <div>Wed</div> <div>Thu</div> <div>Fri</div> <div>Sat</div>
                        </div>
                    </div>
                    
                    <!-- Chart: tweets per day -->
                    <div style="margin-top:16px;">
                        <canvas id="analytics-chart" height="120"></canvas>
                    </div>
                    
                    <!-- Export Buttons -->
                    <div style="margin-top: 16px; display: flex; gap: 10px;">
                        <button id="export-csv" class="tab-btn" style="font-size: 0.9rem; padding: 6px 12px;">Export CSV</button>
                        <button id="export-json" class="tab-btn" style="font-size: 0.9rem; padding: 6px 12px;">Export JSON</button>
                    </div>
                </div>
            </section>

            <!-- 2) Top 10 authors with filter -->
            <section class="analytics-nested-content" id="analytics-authors-section" data-analytics-section="authors">
                <div class="analytics-block" id="analytics-top-authors-block">
                    <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
                        <h3 style="margin:0;">Top 10 authors</h3>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <label for="author-metric-select" style="font-weight:600; color:#a9ddd3;">Sort by:</label>
                            <select id="author-metric-select">
                                <option value="posts">Posts</option>
                                <option value="likes">Likes</option>
                                <option value="views">Views</option>
                            </select>
                        </div>
                    </div>
                    <ol id="top-authors-list" style="margin-top:12px;"></ol>
                </div>
            </section>

            <!-- 3) Top 10 posts with filter -->
            <section class="analytics-nested-content" id="analytics-posts-section" data-analytics-section="posts">
                <div class="analytics-block" id="analytics-top-posts-block">
                    <div style="display:flex; align-items:center; justify-content:space-between; gap:12px;">
                        <h3 style="margin:0;">Top 10 posts</h3>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <label for="post-metric-select" style="font-weight:600; color:#a9ddd3;">Sort by:</label>
                            <select id="post-metric-select">
                                <option value="likes">Likes</option>
                                <option value="views">Views</option>
                            </select>
                        </div>
                    </div>
                    <ol id="top-posts-list" style="margin-top:12px;"></ol>
                </div>
            </section>
        </div>
    </div>

    <!-- Chart.js CDN for analytics charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>

  <!-- ... ваш существующий HTML до </body> ... -->

  <!-- Snow effect container -->
  <div class="snow-container" id="snowContainer"></div>

  <!-- Chart.js CDN for analytics charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="script.js"></script>
</body>
</html>


